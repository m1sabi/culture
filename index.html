<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <!-- Ensures the page is responsive on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>توقيت صلاة الفجر والعشاء حسب فتوى مجلس الإفتاء الأوروبي - 2015</title>

  <style>
	.link-container img {
      width: 60px; /* Resize the image width */
      height: auto; /* Maintain aspect ratio */
    }
	.link-container-w img {
      width: 40px; /* Resize the image width */
      height: auto; /* Maintain aspect ratio */
    }
	.modal {
		display: none;
		position: fixed;
		z-index: 1000;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
		width: 80%;
		max-width: 400px;
		background-color: white;
		border: 2px solid #333;
		padding: 20px;
		text-align: center;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
	}

	.modal-content {
		font-size: 18px;
		font-weight: bold;
	}

	.close {
		cursor: pointer;
		float: right;
		font-size: 24px;
		font-weight: bold;
	}
	.bold-text {
      font-weight: bold;
	  font-size: 0.8rem;
	}
	.expl {
      font-weight: bold;
      font-size: 0.8rem;
    }
	.center-container {
      display: flex;
      justify-content: center;
    }
	#city-list-container {
		width: 30%;  /* Set width to 30% of the page */
		margin: auto; /* Center it horizontally */
		text-align: center; /* Center the content inside */
		font-size: 0.6rem;
	}
	#city-list-container2 {
		width: 30%;  /* Set width to 30% of the page */
		margin: auto; /* Center it horizontally */
		text-align: center; /* Center the content inside */
		font-size: 1rem;
	}
    body {
	
      display: flex;
      justify-content: center;
      align-items: flex-start;
      height: 100vh;
      margin: 0;
      direction: rtl; /* Arabic Right-to-Left */
      font-family: Arial, sans-serif;
    }
    h1 {
      text-align: center;
    }
    .selectors {
      text-align: center;
      margin: 20px 0;
    }
    select, button {
      font-size: 1rem;
      margin: 0 5px;
      padding: 4px 8px;
      cursor: pointer;
    }

    /* Table layout */
    table {
      border-collapse: collapse;
      margin: 20px auto; /* center horizontally */
      width: 300px;
      max-width: 100%; /* so it doesn't overflow on small screens */
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px 10px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
      width: 120px;
    }
    .row-separator {
      border-bottom: 2px solid red; /* example style */
    }
    .gr {
      color: green;
	  font-weight: bold;
    }

    .centered {
      text-align: center;
    }
	#tawkeet {
		margin: auto; /* Center it horizontally */
		text-align: center; /* Center the text */
		font-size: 3.0rem;
	}
	
	 

	
    /* Media query for smaller screens */
    @media (max-width: 600px) {
      body {
        margin: 10px;
      }
      select, button {
        font-size: 0.9rem; /* slightly smaller text on small screens */
      }
      table {
        width: 100%; /* use full width on mobile */
      }
	     #city-list-container {
			width: 100%; /* Full width on mobile */
			color: blue;
			font-size: 0.5rem;
		}
		#city-list-container2 {
			width: 100%; /* Full width on mobile */
			color: blue;
			font-size: 0.9rem;
		}
		body {
        flex-direction: column;
      }
	  .text-column {
        width: 100%;
      }
	  
	
    }
  </style>
</head>
<body>


<!-- Right column (Prayer Time Content) -->
<div class="column text-column">
  <div class="content-box">

	<p class="centered">
توقيت صلاة الفجر والعشاء حسب فتوى مجلس الإفتاء الأوروبي - 2015
<br><span class="gr centered">طيلة أيام شهر رمضان المبارك</span>
<br><span>حسب قاعدة ساعة و5 دقائق - قبل الشروق .. وبعد الغروب</span></p>

<p class="centered">
  
</p>

 <!-- <div id="city-list-container"></div>--> 
<div class="selectors">
    <!-- City selector -->
    <label for="citySelect">اختر المدينة:</label>
    <select id="citySelect"></select>
	
  <p style="text-align: center; font-weight: bold; margin-top: 10px;";>
    Latitude (خط العرض): <span id="latitudeCell">—</span>
  </p>


    <!-- Day controls: prev day button, day select, next day button -->
    <button id="prevDayBtn">اليوم السابق ←</button>
    <select id="daySelect"></select>
    <button id="nextDayBtn">→ اليوم التالي</button>
  </div>

  <!-- Table to show the chosen city/day times -->
  
  
  <table>
    <tr>
      <th>اليوم</th>
      <td id="selectedDayCell">—</td>
      <th>Makka-Fotor (فطور مكة)</th>
    </tr>
    <tr>
      <th>الشروق</th>
      <td id="sunriseCell">—</td>
      <td>—</td>
    </tr>
    <tr class="row-separator">
      <th>الفجر</th>
      <td id="fajrCell">—</td>
      <td>—</td>
    </tr>
    <tr>
      <th>الغروب</th>
      <td id="sunsetCell">—</td>
      <td id="makkaFotorCell" class="green-text">—</td>
	  
    </tr>
    <tr>
      <th>العشاء</th>
      <td id="ishaaCell">—</td>
      <td>—</td>
    </tr>
  </table>
  
<p id="city-list-container2">
    توقيت الفطور قياساً إلى مكة للمدن الواقعة شمال خط العرض 49 يكون فارقاً فقط في اليوم غير الطبيعي، أي الذي يزيد طول النهار فيه على 18 ساعة، أما في الشتاء فقد يتساويان أو يكون النهار هنا أقصر
	<br>
	<span class="bold-text">ملاحظة: لإصدار صوت الأذان يجب منح الإذن لمتصفح الإنترنت</span>
</p>



  <script src="cities-data.js"></script>
  <script>
    // Now we can access `allCitiesData` from cities-data.js
    console.log(allCitiesData.stuttgart);
  </script>
  <!-- read the list of cities -->
  <script>
    // cityListHtml is now available here
    document.addEventListener("DOMContentLoaded", () => {
      // 1) Create a container or target element
      const cityListContainer = document.getElementById("city-list-container");
      // 2) Insert the HTML from cities-data.js
      cityListContainer.innerHTML = cityListHtml;
    });
  </script>

  <script>
    // ========================= DOM REFERENCES =========================
    const citySelect   = document.getElementById("citySelect");
    const daySelect    = document.getElementById("daySelect");
    const prevDayBtn   = document.getElementById("prevDayBtn");
    const nextDayBtn   = document.getElementById("nextDayBtn");

    const selectedDayCell = document.getElementById("selectedDayCell");
    const sunriseCell     = document.getElementById("sunriseCell");
    const sunsetCell      = document.getElementById("sunsetCell");
    const fajrCell        = document.getElementById("fajrCell");
    const ishaaCell       = document.getElementById("ishaaCell");

    // ========================= UTILITY FUNCTIONS =========================
    function timeToMinutes(t) {
      // "HH:MM" -> total minutes
      const [hh, mm] = t.split(":").map(Number);
      return hh * 60 + mm;
    }
    function minutesToTime(m) {
      // total minutes -> "HH:MM" (24h)
      const hh = Math.floor(m / 60);
      const mm = m % 60;
      // Pad with leading zeros if needed
      return String(hh).padStart(2, "0") + ":" + String(mm).padStart(2, "0");
    }
    function subtract1h05(timeStr) {
      return minutesToTime(timeToMinutes(timeStr) - 65);
    }
    function add1h05(timeStr) {
      return minutesToTime(timeToMinutes(timeStr) + 65);
    }

    // ========================= High Latitude Data =========================
    // List of city keys with latitude >= 49°
    const highLatCities = [
      "dortmund", "bremen", "duesseldorf", "essen", "leipzig",
      "berlin", "nuremberg", "karlsruhe", "mannheim", "frankfurt",
      "kiel", "hamburg", "koblenz", "regensburg", "erfurt",
      "rostock", "flensburg"
    ];
    // Makkah's sunrise and sunset times for days 1–30 (March 2025)
    

    // ========================= LOGIC: UPDATE THE TABLE =========================
    function updateTable() {
    const city = citySelect.value.toLowerCase(); // Ensure city key matches data
    const day = parseInt(daySelect.value, 10);

    console.log("Selected City:", city); // Debugging log
    console.log("City Data:", allCitiesData[city]); // Debugging log
    console.log("Latitude Data:", cityLatitude[city]); // Debugging log

    if (!allCitiesData[city]) {
        console.error("City not found in allCitiesData");
        return;
    }

    const found = allCitiesData[city].find(item => item.day === day);
    if (!found) {
        console.warn(`No data for day ${day} in city ${city}`);
        return;
    }

    selectedDayCell.textContent = `يوم ${day} مارس 2025`;
    sunriseCell.textContent = found.sunrise;
    sunsetCell.textContent = found.sunset;

    const fajr = subtract1h05(found.sunrise);
    const ishaa = add1h05(found.sunset);
    fajrCell.textContent = fajr;
    ishaaCell.textContent = ishaa;

      // If high-latitude city, calculate Makka-based iftar time; otherwise blank
      if (highLatCities.includes(city)) {
        const makkaDayData = makkahData.find(item => item.day === day);
        if (makkaDayData) {
          const makkaFajr = subtract1h05(makkaDayData.sunrise);
          // Duration of fast in Makkah (minutes)
          let makkaFastMin = timeToMinutes(makkaDayData.sunset) - timeToMinutes(makkaFajr);
          if (makkaFastMin < 0) makkaFastMin += 24 * 60;
          // Add Makkah fast duration to the city’s Fajr (in minutes)
          const cityFajrMin = timeToMinutes(fajr);
          let makkaIftarMin = cityFajrMin + makkaFastMin;
          if (makkaIftarMin >= 24 * 60) makkaIftarMin -= 24 * 60;
          const makkaIftar = minutesToTime(makkaIftarMin);
          document.getElementById("makkaFotorCell").textContent = makkaIftar;
        }
      } else {
        document.getElementById("makkaFotorCell").textContent = "—";
      }

      // Enable/disable day navigation arrows at boundaries
      const minDay = 1;
      const maxDay = 30;
      prevDayBtn.disabled = (day <= minDay);
      nextDayBtn.disabled = (day >= maxDay);
    }

    // ========================= ARROW HANDLERS =========================
    function goPrevDay() {
      let d = parseInt(daySelect.value, 10);
      if (d > 1) {
        daySelect.value = (d - 1).toString();
        updateTable();
      }
    }
    function goNextDay() {
      let d = parseInt(daySelect.value, 10);
      if (d < 30) {
        daySelect.value = (d + 1).toString();
        updateTable();
      }
    }

    // ========================= EVENT LISTENERS =========================
    citySelect.addEventListener("change", () => {
      // When user changes city, reset day to 1 for simplicity
      daySelect.value = "1";
      updateTable();
    });
    daySelect.addEventListener("change", updateTable);
    prevDayBtn.addEventListener("click", goPrevDay);
    nextDayBtn.addEventListener("click", goNextDay);

    // ========================= INITIALIZE DEFAULT SELECTION =========================
    citySelect.value = cityNames[0];   // default to first city
    daySelect.value = "1";            // default to day 1
    updateTable();
  </script>

  <!-- Container for city list (inserted via script) -->
  

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate(); // Get today's day (1-31)
      daySelect.value = todayDay <= 30 ? todayDay : 30; // Ensure max day is 30

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);
		let cityKey = city.toLowerCase(); // Normalize city name
		if (cityLatitude[cityKey]) {
			latitudeCell.textContent = `${cityLatitude[cityKey].lat}°`;
		} else {
			latitudeCell.textContent = "—";
		}

		if (cityLatitude[city]) {
			latitudeCell.textContent = `${cityLatitude[city].lat}°`;
		} else {
			latitudeCell.textContent = "—";
		}
		localStorage.setItem("selectedCity", city);
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");

      // Populate the city dropdown
      for (let city in allCitiesData) {
        let option = document.createElement("option");
        option.value = city;
        option.textContent = city.charAt(0).toUpperCase() + city.slice(1);
        citySelect.appendChild(option);
      }

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Populate the day dropdown (1 to 30)
      for (let i = 1; i <= 30; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
      }

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate() <= 30 ? today.getDate() : 30;
      daySelect.value = todayDay;

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);

        localStorage.setItem("selectedCity", city);
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");

      // Populate city dropdown
      for (let city in allCitiesData) {
        let option = document.createElement("option");
        option.value = city;
        option.textContent = city.charAt(0).toUpperCase() + city.slice(1);
        citySelect.appendChild(option);
      }

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Populate the day dropdown (1 to 30)
      for (let i = 1; i <= 30; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
      }

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate() <= 30 ? today.getDate() : 30;
      daySelect.value = todayDay;

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);

        localStorage.setItem("selectedCity", city);

        // Calculate Maghrib for high latitude cities (>= 49°)
        if (highLatCities.includes(city)) {
          const makkahDayData = makkahData.find(item => item.day === day);
          const makkahFajrData = makkahFajr.find(item => item.day === day);
          if (makkahDayData && makkahFajrData) {
            const makkahSunset = makkahDayData.sunset;
            const makkahFajrTime = makkahFajrData.Fajr;

            // Compute fasting duration in Makkah (in minutes)
            let makkahFastMin = timeToMinutes(makkahSunset) - timeToMinutes(makkahFajrTime);
            if (makkahFastMin < 0) makkahFastMin += 24 * 60;

            // Compute Maghrib time for the city
            const cityFajrMin = timeToMinutes(fajr);
            let cityMaghribMin = cityFajrMin + makkahFastMin;
            if (cityMaghribMin >= 24 * 60) cityMaghribMin -= 24 * 60;

            const cityMaghrib = minutesToTime(cityMaghribMin);
            makkaFotorCell.textContent = cityMaghrib;
          } else {
            makkaFotorCell.textContent = "—";
          }
        } else {
          makkaFotorCell.textContent = "—";
        }
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");
      const latitudeCell = document.getElementById("latitudeCell");

      // Populate city dropdown
      for (let city in allCitiesData) {
        let option = document.createElement("option");
        option.value = city;
        option.textContent = city.charAt(0).toUpperCase() + city.slice(1);
        citySelect.appendChild(option);
      }

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Populate the day dropdown (1 to 30)
      for (let i = 1; i <= 30; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
      }

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate() <= 30 ? today.getDate() : 30;
      daySelect.value = todayDay;

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);

        localStorage.setItem("selectedCity", city);

        // Display Latitude and Altitude
		if (cityLatitude[city]) {
			latitudeCell.textContent = `${cityLatitude[city].lat}°`;
			altitudeCell.textContent = `${cityLatitude[city].alt}m`;
		} else {
			latitudeCell.textContent = "—";
			altitudeCell.textContent = "—";
		}


        // Calculate Maghrib for high latitude cities (>= 49°)
        if (highLatCities.includes(city)) {
          const makkahDayData = makkahData.find(item => item.day === day);
          const makkahFajrData = makkahFajr.find(item => item.day === day);
          if (makkahDayData && makkahFajrData) {
            const makkahSunset = makkahDayData.sunset;
            const makkahFajrTime = makkahFajrData.Fajr;

            // Compute fasting duration in Makkah (in minutes)
            let makkahFastMin = timeToMinutes(makkahSunset) - timeToMinutes(makkahFajrTime);
            if (makkahFastMin < 0) makkahFastMin += 24 * 60;

            // Compute Maghrib time for the city
            const cityFajrMin = timeToMinutes(fajr);
            let cityMaghribMin = cityFajrMin + makkahFastMin;
            if (cityMaghribMin >= 24 * 60) cityMaghribMin -= 24 * 60;

            const cityMaghrib = minutesToTime(cityMaghribMin);
            makkaFotorCell.textContent = cityMaghrib;

            // Compare Makka-based Maghrib with the city's sunset
            const citySunsetMin = timeToMinutes(found.sunset);
            if (cityMaghribMin < citySunsetMin) {
              makkaFotorCell.style.color = "green";
              makkaFotorCell.style.fontWeight = "bold";
            } else {
              makkaFotorCell.style.color = "black";
              makkaFotorCell.style.fontWeight = "normal";
            }
          } else {
            makkaFotorCell.textContent = "—";
          }
        } else {
          makkaFotorCell.textContent = "—";
        }
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");
      const latitudeCell = document.getElementById("latitudeCell");

      // Populate city dropdown
      for (let city in allCitiesData) {
        let option = document.createElement("option");
        option.value = city;
        option.textContent = city.charAt(0).toUpperCase() + city.slice(1);
        citySelect.appendChild(option);
      }

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Populate the day dropdown (1 to 30)
      for (let i = 1; i <= 30; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
      }

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate() <= 30 ? today.getDate() : 30;
      daySelect.value = todayDay;

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);

        localStorage.setItem("selectedCity", city);
		
        // Display Latitude
        if (cityLatitude[city]) {
			latitudeCell.textContent = `${cityLatitude[city].lat}°`;
		} else {
			latitudeCell.textContent = "—";
		}
		
		document.addEventListener("DOMContentLoaded", () => {
    const citySelect = document.getElementById("citySelect");
    const latitudeCell = document.getElementById("latitudeCell");
    const latitudeMessage = document.getElementById("latitudeMessage");
	if (latitudeMessage) {
		latitudeMessage.textContent = "يتم عرض فطور مكة فقط للمدن الواقعة شمال خط العرض 49";
	}
    function updateTable() {
        const city = citySelect.value.toLowerCase();
		const latitudeMessage = document.getElementById("latitudeMessage");
		if (latitudeMessage) {
			latitudeMessage.textContent = "يتم عرض فطور مكة فقط للمدن الواقعة شمال خط العرض 49";
		}

		if (cityLatitude[city]) {
			latitudeCell.textContent = `${cityLatitude[city].lat}°`;

        // Display the message
			latitudeMessage.textContent = "يتم عرض فطور مكة فقط للمدن الواقعة شمال خط العرض 49";
			latitudeMessage.style.display = "block"; // Ensure it's visible
		} else {
			latitudeCell.textContent = "—";
			latitudeMessage.textContent = ""; // Hide the message
		}
    }

    citySelect.addEventListener("change", updateTable);
});

		
        // Calculate Maghrib for high latitude cities (>= 49°)
        if (highLatCities.includes(city)) {
          const makkahDayData = makkahData.find(item => item.day === day);
          const makkahFajrData = makkahFajr.find(item => item.day === day);
          if (makkahDayData && makkahFajrData) {
            const makkahSunset = makkahDayData.sunset;
            const makkahFajrTime = makkahFajrData.Fajr;

            // Compute fasting duration in Makkah (in minutes)
            let makkahFastMin = timeToMinutes(makkahSunset) - timeToMinutes(makkahFajrTime);
            if (makkahFastMin < 0) makkahFastMin += 24 * 60;

            // Compute Maghrib time for the city
            const cityFajrMin = timeToMinutes(fajr);
            let cityMaghribMin = cityFajrMin + makkahFastMin;
            if (cityMaghribMin >= 24 * 60) cityMaghribMin -= 24 * 60;

            const cityMaghrib = minutesToTime(cityMaghribMin);
            makkaFotorCell.textContent = cityMaghrib;

            // Compare Makka-based Maghrib with the city's sunset
            const citySunsetMin = timeToMinutes(found.sunset);
            if (cityMaghribMin < citySunsetMin) {
              makkaFotorCell.style.color = "green";
              makkaFotorCell.style.fontWeight = "bold";
            } else {
              makkaFotorCell.style.color = "black";
              makkaFotorCell.style.fontWeight = "normal";
            }
          } else {
            makkaFotorCell.textContent = "—";
          }
        } else {
          makkaFotorCell.textContent = "—";
        }
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const citySelect = document.getElementById("citySelect");
      const daySelect = document.getElementById("daySelect");
      const prevDayBtn = document.getElementById("prevDayBtn");
      const nextDayBtn = document.getElementById("nextDayBtn");
      const selectedDayCell = document.getElementById("selectedDayCell");
      const sunriseCell = document.getElementById("sunriseCell");
      const sunsetCell = document.getElementById("sunsetCell");
      const fajrCell = document.getElementById("fajrCell");
      const ishaaCell = document.getElementById("ishaaCell");
      const makkaFotorCell = document.getElementById("makkaFotorCell");
      const latitudeCell = document.getElementById("latitudeCell");

      // Populate city dropdown
      for (let city in allCitiesData) {
        let option = document.createElement("option");
        option.value = city;
        option.textContent = city.charAt(0).toUpperCase() + city.slice(1);
        citySelect.appendChild(option);
      }

      // Load stored city or default to first city
      const savedCity = localStorage.getItem("selectedCity");
      citySelect.value = savedCity || citySelect.options[0].value;

      // Populate the day dropdown (1 to 30)
      for (let i = 1; i <= 30; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
      }

      // Set today's date
      const today = new Date();
      const todayDay = today.getDate() <= 30 ? today.getDate() : 30;
      daySelect.value = todayDay;

      function updateTable() {
        const city = citySelect.value;
        const day = parseInt(daySelect.value, 10);
        const cityData = allCitiesData[city];
        if (!cityData) return;

        const found = cityData.find(item => item.day === day);
        if (!found) return;

        selectedDayCell.textContent = `يوم ${day} مارس 2025`;
        sunriseCell.textContent = found.sunrise;
        sunsetCell.textContent = found.sunset;

        const fajr = subtract1h05(found.sunrise);
        const ishaa = add1h05(found.sunset);
        fajrCell.textContent = fajr;
        ishaaCell.textContent = ishaa;

        prevDayBtn.disabled = (day <= 1);
        nextDayBtn.disabled = (day >= 30);

        localStorage.setItem("selectedCity", city);

        // Display Latitude based on selected city
        if (cityLatitude[city]) {
			latitudeCell.textContent = `${cityLatitude[city].lat}°`;
		} else {
			latitudeCell.textContent = "—";
		}

        // Calculate Maghrib for high latitude cities (>= 49°)
        if (highLatCities.includes(city)) {
          const makkahDayData = makkahData.find(item => item.day === day);
          const makkahFajrData = makkahFajr.find(item => item.day === day);
          if (makkahDayData && makkahFajrData) {
            const makkahSunset = makkahDayData.sunset;
            const makkahFajrTime = makkahFajrData.Fajr;

            // Compute fasting duration in Makkah (in minutes)
            let makkahFastMin = timeToMinutes(makkahSunset) - timeToMinutes(makkahFajrTime);
            if (makkahFastMin < 0) makkahFastMin += 24 * 60;

            // Compute Maghrib time for the city
            const cityFajrMin = timeToMinutes(fajr);
            let cityMaghribMin = cityFajrMin + makkahFastMin;
            if (cityMaghribMin >= 24 * 60) cityMaghribMin -= 24 * 60;

            const cityMaghrib = minutesToTime(cityMaghribMin);
            makkaFotorCell.textContent = cityMaghrib;

            // Compare Makka-based Maghrib with the city's sunset
            const citySunsetMin = timeToMinutes(found.sunset);
            if (cityMaghribMin < citySunsetMin) {
              makkaFotorCell.style.color = "green";
              makkaFotorCell.style.fontWeight = "bold";
            } else {
              makkaFotorCell.style.color = "black";
              makkaFotorCell.style.fontWeight = "normal";
            }
          } else {
            makkaFotorCell.textContent = "—";
          }
        } else {
          makkaFotorCell.textContent = "—";
        }
      }

      citySelect.addEventListener("change", () => {
        daySelect.value = "1"; // Reset to first day when changing city
        updateTable();
      });
      daySelect.addEventListener("change", updateTable);
      prevDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d > 1) {
          daySelect.value = (d - 1).toString();
          updateTable();
        }
      });
      nextDayBtn.addEventListener("click", () => {
        let d = parseInt(daySelect.value, 10);
        if (d < 30) {
          daySelect.value = (d + 1).toString();
          updateTable();
        }
      });

      updateTable(); // Load initial data
    });
  </script>
  
  <audio id="azanSound" src="Haddad.mp3" preload="auto"></audio>
  
  <!-- To test Athan sound manually
  <button onclick="playAzan(); showNotification('Test Alarm');">
    🔔 Test Maghrib Alarm
  </button><br>
	 -->
	 <br>
<div class="center-container"><button onclick="stopAzan()">⏹️ Stop Azan</button></div>
<div id="prayerPopup" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <p id="prayerMessage"></p>
    </div>
</div>
  <script>
// Get the audio element for Azan
const azanSound = document.getElementById("azanSound");

// Request Notification Permission on Page Load
document.addEventListener("DOMContentLoaded", () => {
    if ("Notification" in window) {
        Notification.requestPermission().then(permission => {
            if (permission === "granted") {
                console.log("🔔 Notification permission granted.");
            } else {
                console.log("❌ Notifications blocked by user.");
            }
        });
    } else {
        console.log("❌ Notifications are not supported in this browser.");
    }

    // Start checking prayer time every 30 seconds
    setInterval(checkPrayerTime, 30000); // Check every 30 seconds
});

// Function to play Azan
function playAzan() {
    if (azanSound) {
        azanSound.play().catch(error => {
            console.log("🔇 Audio playback failed:", error);
        });
    } else {
        console.log("⚠️ Azan sound element not found!");
    }
}

// Function to stop Azan
function stopAzan() {
    if (azanSound) {
        azanSound.pause();
        azanSound.currentTime = 0; // Reset to the start
    }
}

// Function to show a web notification
function showNotification(prayerName) {
    if (Notification.permission === "granted") {
        const notification = new Notification(`📢 ${prayerName} Time!`, {
            body: `It's time for ${prayerName}. Click to stop Azan.`,
            icon: "azan_icon.png", // Ensure this file exists
            silent: false
        });

        // Clicking the notification stops the Azan
        notification.onclick = () => {
            stopAzan();
            notification.close();
        };
    } else {
        console.log("🚫 Notifications not allowed.");
    }
}
function showPopup(message) {
    document.getElementById("prayerMessage").textContent = message;
    document.getElementById("prayerPopup").style.display = "block";
}
document.querySelector(".close").addEventListener("click", function () {
    document.getElementById("prayerPopup").style.display = "none";
});

// Function to check the current time and trigger Azan
function checkPrayerTime() {
    const now = new Date();
    const currentTime = now.getHours().toString().padStart(2, "0") + ":" + now.getMinutes().toString().padStart(2, "0");

    // Get Maghrib and Fajr times from your table
    const maghribTime = document.getElementById("sunsetCell").textContent.trim();
    const fajrTime = document.getElementById("fajrCell").textContent.trim();

    console.log("⌚ Current Time:", currentTime);
    console.log("🌅 Fajr Time:", fajrTime);
    console.log("🌇 Maghrib Time:", maghribTime);

    // Compare times and trigger Azan & Notification if they match
    if (currentTime === fajrTime) {
        playAzan();
        showNotification("Fajr");
	//	alert("📢 وقت الفجر! حان الآن وقت صلاة الفجر.");
		showPopup("📢 وقت الفجر! حان الآن وقت صلاة الفجر.");
    } else if (currentTime === maghribTime) {
        playAzan();
        showNotification("Maghrib");
	//	alert("📢 وقت المغرب! حان الآن وقت صلاة المغرب.");
		showPopup("📢 وقت المغرب! حان الآن وقت صلاة المغرب.");
    }
}
// Start checking every 30 seconds
setInterval(checkPrayerTime, 10000);

	</script>

  </div>
</div>

<!-- Left column (Links) -->
<div class="column list-column">
<ul>
  
	<br>
    <li><a href="explain.html">ماذا تعرف عن قاعدة ساعة و5 دقائق؟</a></li>
    <br><li><span class="expl">تحميل متصفح موزيلا Mozilla firefox</span></li><br>
  
	<div class="link-container-w">
		<a href="https://www.mozilla.org/en-US/firefox/browsers/windows-64-bit/">
		<img src="images\windows.png" alt="Download on the App Store"></a>
	</div>
  
	<div class="link-container">
		<a href="https://apps.apple.com/us/app/firefox-private-safe-browser/id989804926">
		<img src="images\App Store.png" alt="Download on the App Store"></a>
	</div>
  
  
	<div class="link-container">
		<a href="https://apps.apple.com/us/app/apple-store/id989804926?pt=373246&ct=firefox-browsers-mobile-ios&mt=8">
		<img src="images\Google Play.png" alt="GET IT ON Google Play"></a>
	</div>
  
	</div>
</ul>
</div>


</body>
</html>
